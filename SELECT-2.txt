with 

battleDateParts as (select 
  datepart(year, date) yearPart,
  datepart(month, date) monthPart,
  datepart(year, dateadd(month, 1, date)) nextYearPart,
  datepart(month, dateadd(month, 1, date)) nextMonthPart
  from battles ), 

battleDateMonthStartsEnds as (select
  datefromparts(yearPart, monthPart, 1) monthStart,
  datediff(day, 
    datefromparts(yearPart, monthPart, 1),
    datefromparts(nextYearPart, nextMonthPart, 1)) as dayCount 
  from battleDateParts
),

battleDateMonthStartsEndsWithDayOfWeek as (select
  case 
    when format(monthStart, 'dddd') = 'Monday' then 1
    when format(monthStart, 'dddd') = 'Tuesday' then 2
    when format(monthStart, 'dddd') = 'Wednesday' then 3
    when format(monthStart, 'dddd') = 'Thursday' then 4
    when format(monthStart, 'dddd') = 'Friday' then 5
    when format(monthStart, 'dddd') = 'Saturday' then 6
    when format(monthStart, 'dddd') = 'Sunday' then 7
  end as dayOfWeek,
  format(monthStart, 'dddd') as spelledDayOfWeek,
  * from battleDateMonthStartsEnds
)

select * from battleDateMonthStartsEndsWithDayOfWeek
